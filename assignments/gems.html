---
layout: assignment
title: Gems Assignment
---

<div class="csusbdt-video-btn">
  <a class="btn btn-success" role="button" target="_blank" href="http://youtu.be/2-F1uyztaiE">Video</a>
</div>

<h2>Overview</h2>

<p>
The learning objectives for this assignment include the following.
</p>

<ul>
<li>Understand how to implement authentication and authorization.</li>
<li>Understand how to build a single-page Web application.</li>
<li>Understand how to store application state on the server side.</li>
<li>Improve your knowledge and skills with the document object model (DOM).</li>
<li>Understand how to use localStorage to minimize user login.</li>
<li>Understand how to implement server-side input validation.</li>
<li>Understand a simple solution to the problem of stale client-side data.</li>
</ul>

<h2>Assignment folder</h2>

<p>
Create a directory named <em>gems</em> for the work you do for this assignment. 
This folder should contain your project code and a file <em>README.md</em> with notes. 
You should create this folder by cloning the gems repository into <em>~/405</em> and
then deleting the <em>.git</em> folder within gems.  
Here are the commands to use.
</p>

<pre>
cd ~/405
git clone https://github.com/csusbdt/gems.git
cd gems
rm -rf .git
</pre>

<p class="csusbdt-callout">
Deleting the .git folder of the cloned gems project
enables you to add the gems project code to your 405 repository.
</p>

<h2>Instructions</h2>

<p>
Study the gems project code to understand its function.
Then, add a game screen with the following elements.
</p>

<ul>
<li>a text field that shows how many gems the user has</li>
<li>a text field that shows the user's score in the game</li>
<li>a button that when clicked consumes a gem and increases the score by one point</li>
<li>a button to exit to the main menu screen</li>
</ul>

<p>
In couchDB, documents have revision string.
When you update a document, you need to provide the current revision 
for the document you are updating.
If the revision label you submit does not match the current revision string
in the document, then CouchDB will not perform the update.
In this case, it returns a result object 
that contains an attribute named <code>error</code>
set to the string <code>'conflict'</code>.
This outcome occurs when two separate activities are trying to update the same document.
If both of these activities obtain the version string for a document before either
of them does an update, then a race condition is set up.
The activity that executes the update first wins and the one that follows loses.
</p>

<p>
The gem application uses a simple strategy to resolve version conflicts;
it updates the user's view of the information in the document, tells the user
that something has changed and suggests that the user try again.
To test this in the gem application,
open 2 different browsers and log in as user 'a' in both browsers.
By a gem in one browser window and without refreshing the screen, 
try to buy a gem in the other browser window.
The application updates the balance and gem count that is displayed and
then asks the user to try again.
As you extend the gems application, you should 
follow this pattern to resolve revision conflicts wherever they may occur.
</p>

<!--p>
Revision conflicts within transactions.
A transaction is when 2 or more operations are performed.
For example, a user reads their balance and then purchases a gem.
In the above example, the user's balance changes between the time the user
reads the balance and purchases a gem.
This is a user transaction because the user is performing 2 operations.
It is easy to test revision conflicts in user transactions
because you can control the timing of user actions.
In the next assignment,
you will need to handle a revision conflict in an application-level transaction,
which is more difficult to test.
</p-->

<p>
The <a href="https://github.com/csusbdt/gems/blob/master/README.md">README.md</a> 
file in the project contains links to videos I made that explain the code.
</p>

