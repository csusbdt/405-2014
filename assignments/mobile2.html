---
layout: assignment
title: Webview Assignment
---

<h2>Overview</h2>

<p>
In this assignment,
you will convert your gift Web application to an Android application.
This assignment builds on the gift and the ant assignments.
</p>

<p>
The purpose of this assignment is to learn 
how to convert a Web application 
to a native Android application. 
The process for iOS is similar but will not be covered.
See <a href="http://developer.android.com/sdk">the Android SDK documentation</a> 
for additional information information ion the techniques illustrated in this assignment.
</p>

<h2>Articles Related to WebView</h2>

<ul>
<li><a href="https://www.facebook.com/notes/facebook-engineering/buck-how-we-build-android-apps-at-facebook/10151454619998920">Buck: How we build Android apps at Facebook</a></li>
</ul>

<h2>Assignment folder</h2>

<p>
Create a directory named <em>webview</em> 
for the work you do for this assignment. 
Copy the contents of the <em>gift</em> folder 
into the <em>webview</em> folder.
Test that your copied gift application works when started from the webview folder.
</p>

<p>
Copy <em>~/405/ant/build.xml</em> into the webview folder.
Copy the <em>gen-keystore</em> script from the <em>ant</em> folder to the webview folder.
Run the <em>gen-keystore</em> script to generate the keystore.
</p>

<p>
Make sure that the files generated from the build script and the keystore script are
omitted from the repository by adding the following lines to <em>~/405/.gitignore</em>.
</p>

<pre>
/webview/gift.keystore
/webview/temp
</pre>

<h2>Define an Android Manifest File</h2>

<p>
Android applications use a file named <em>AndroidManifest.xml</em>
to declare properties and requirements of the application 
to the end user's operating system.
An initial manifest file is created when we generate the project.
We will modify this generated file to include configuration that
is specific to your application
and then replace the generated manifest file with our own as part of the build process.
Start by runing the <em>ant create-proj</em> target to generate the project files,
then copy <em>AndroidManifest.xml</em> to the top level of the webview folder.
</p>

<pre>
ant create-proj
cp temp/AndroidManifest.xml .
</pre>

<p>
Android applications need to declare their dependence on certain services,
one of them being the ability to connect to outside hosts on the Internet.
Because the gift application depends on the ability to connect to the Internet,
we need to request this service in the manifest file.
Add the following XML element to the root element of the <em>AndroidManifest.xml</em>.
</p>

<pre>
&lt;uses-permission android:name="android.permission.INTERNET" />
</pre>

<p>
Notice references to <em>@string/app_name</em> in the manifest file.
These are references to a string resource named <em>app_name</em>,
which are defined in a file named <em>strings.xml</em>.
Similar to the manifest file,
we will maintain our own version of this file
</p>




<h2>Modify Your App Content</h2>

<p>
Before committing your work to the repository, 
add the following lines to <em>~/405/.gitignore</em>. 
These are derived files that should not be stored in the repository.
</p>

<pre>
/mobile/android/temp
</pre>

<p>
If <em>~/405/.gitignore</em> doesn't exist, 
then create it with a text editor. 
Make sure you add this file to your repository.
</p>

<hr>
<p>
Change the app name in the following file to <em>App322</em>.
</p>

<pre>
app322/res/values/strings.xml
</pre>

<p>
Build the app.
</p>

<p>
Replace the contents of `app322/res/layout/main.xml` with the following.
</p>

<pre>
<WebView  xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
/>
</pre>

<p>
Replace the contents of <em>app322/src/cse322/app/MainActivity.java</em> with the following.
</p>

<pre>
package cse322.app;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class MainActivity extends Activity
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        WebView webView = (WebView) findViewById(R.id.main);
        webView.getSettings().setJavaScriptEnabled(true);
        webView.loadUrl("https://github.com/csusbdt/322-2013");
    }
}
</pre>

<p>
Add the following line to `AndroidManifest.xml`.
</p>

<pre>
<uses-permission android:name="android.permission.INTERNET" />
</pre>

<p>
Recompile the code and reinstall the app.
</p>

<pre>
ant debug
ant installd
</pre>

<h2>Testing Your App

<p>
Test that your app displays the course website.  If it doesn't, then you need to troubleshoot before continuing with the next step.
</p>

<h2>Using a Local Webpage in Your App</h2>

<p>
The next step is to package your web application pages inside of the Android application installer and load your index page from the local file system of the device rather than from a remote server on the Internet.
</p>

<p>
Make a directory in the app322 folder of the Android project to hold the Web assets.
</p>

<pre>
mkdir app322/assets
</pre>

<p>
Copy your web page files into this folder.
</p>

<p>
In the MainActivity class, change the url to `file:///android_asset/index.html`
</p>

<h2>Testing Your Final Build

<p>
Build, install and run to test that your Web pages are now an Android application.
</p>

